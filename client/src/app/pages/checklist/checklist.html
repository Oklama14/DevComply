<div class="page-header">
  <nav class="breadcrumb">
    <a routerLink="/dashboard">Home</a>
    <span>‚Ä∫</span>
    <span>Checklist LGPD</span>
  </nav>

  <div class="title-row">
    <h1>Checklist LGPD</h1>
    <button class="btn-primary" (click)="generateReport()">
      <svg width="16" height="16" viewBox="0 0 24 24"><path d="M3 3h13l5 5v13a1 1 0 0 1-1 1H3zM16 3v6h6"/></svg>
      Gerar Relat√≥rio
    </button>
  </div>
</div>

<!-- Cart√£o do projeto -->
<div class="project-card" *ngIf="project">
  <div class="header">
    <h2>Projeto: {{ project.nome }}</h2>
  </div>
  <p class="description">{{ project.descricao }}</p>

  <div class="progress-line">
    <span class="label">Progresso:</span>
    <span class="value">{{ overallProgress }}%</span>
  </div>
  <div class="progressbar">
    <div class="progressbar-fill" [style.width.%]="overallProgress"></div>
  </div>
</div>

<!-- Loading / vazio -->
<div *ngIf="isLoading" class="loading">Carregando checklist‚Ä¶</div>
<div *ngIf="!isLoading && (!checklistData || !checklistData.length)" class="empty">
  Nenhuma pergunta encontrada.
</div>

<!-- Categorias -->
<section *ngFor="let category of checklistData" class="category">
  <div class="category-header">
    <h3>{{ category.nome }}</h3>
    <span class="cat-progress">{{ category.progress || 0 }}% completo</span>
  </div>

  <div class="progressbar small">
    <div class="progressbar-fill" [style.width.%]="category.progress || 0"></div>
  </div>

  <p class="category-desc" *ngIf="category.descricao">{{ category.descricao }}</p>

  <div class="items">
    <article *ngFor="let item of category.items" class="item" [class.item-completed]="item.completed">
      <div class="item-head" (click)="toggleItemExpansion(item)">
        <div class="left">
          <input
            type="checkbox"
            [(ngModel)]="item.completed"
            (click)="$event.stopPropagation()"
            class="lgpd-checkbox"
          />
          <div>
            <h4>{{ item.titulo }}</h4>
            <p class="subtitle" *ngIf="item.descricao">{{ item.descricao }}</p>
          </div>
        </div>

        <div class="right">
          <button
            class="tip"
            title="Ver dica"
            *ngIf="item.tipText"
            (click)="$event.stopPropagation(); showTip(item)"
          >?</button>

          <span class="badge" *ngIf="item.lgpdReference">{{ item.lgpdReference }}</span>

          <span class="chevron" [class.up]="item.expanded">‚åÑ</span>
        </div>
      </div>

      <div class="item-body" *ngIf="item.expanded">
        <p class="inline-tip" *ngIf="item.tipText">
          <strong>üí° Dica:</strong> {{ item.tipText }}
        </p>

        <label class="field">
          <span>Explica√ß√£o da sua implementa√ß√£o:</span>
          <textarea
            [(ngModel)]="item.answer"
            placeholder="Descreva como sua solu√ß√£o atende a este requisito..."
          ></textarea>
        </label>

        <label class="field">
          <span>Detalhes t√©cnicos:</span>
          <textarea
            [(ngModel)]="item.technicalDetails"
            placeholder="Tecnologias, m√©todos de criptografia, estruturas de BD, etc."
          ></textarea>
        </label>
      </div>
    </article>
  </div>
</section>

<!-- Rodap√© de a√ß√µes -->
<div class="footer-actions" *ngIf="!isLoading && checklistData?.length">
  <button class="btn-primary" (click)="generateReport()">Gerar Relat√≥rio</button>
  <button class="btn-secondary" (click)="saveProgress()">Salvar Progresso</button>
</div>
